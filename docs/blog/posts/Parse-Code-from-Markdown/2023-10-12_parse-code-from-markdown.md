---
date:
  created: 2023-10-12
authors:
 - joshooaj
categories:
  - PowerShell
  - Markdown
---

# Parse Code from Markdown Files

Are you testing your documentation? If you write PowerShell scripts or modules, you are *hopefully* using Pester to
test your code. And if you use PlatyPS to generate markdown documentation like I do, then you have a bunch of example
PowerShell code sitting in .md files. But what happens if you rename a command, a parameter, or make some other kind of
breaking change?

<!-- more -->

Your documentation is the face of your product. It's the source of truth for the people who use it, whether it's a
PowerShell module or something else entirely unrelated. When your examples have errors in them, it won't be obvious to
everyone. Some people may copy and paste your examples, and if they throw an error, they may simply walk away.

The [MilestonePSTools](https://www.milestonepstools.com) PowerShell module I work on has 413 markdown files under the
docs folder, and 256 of those files were generated by PlatyPS for commands in the module. I have a bunch of tests for
the module itself, but until today I was not testing *any* examples or other PowerShell code blocks found in the
documentation.

## Get-MdCodeBlock

I now have a couple of data-driven Pester tests that enumerate over all markdown files in the documentation. Using
`Get-MdCodeBlock`, I can extract all the PowerShell code from inline and fenced code blocks and pass the content into
`Invoke-ScriptAnalyzer` to look for common problems.

I'm also using the language parser to get the AST, and then I look for any commands that are either an alias, or don't
exist, so that the users of the module can better rely on the quality of the documentation in the future.

If you find a use for this in your own projects, I'd love to hear how you're using it and how you think it could be improved!

[Download :material-download:](Get-MdCodeBlock.ps1){ .md-button .md-button--primary }

```powershell linenums="1"
--8<-- "/blog/posts/parse-code-from-markdown/Get-MdCodeBlock.ps1"
```
